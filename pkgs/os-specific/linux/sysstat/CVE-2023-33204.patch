a composite of 954ff2e2673cef48f0ed44668c466eab041db387 and its merge
commit 6f8dc568e6ab072bb8205b732f04e685bf9237c0 which includes a fixup.
github's `.patch` urls don't handle this case well, hence patch is
in-repo.

diff --git a/common.c b/common.c
index a3d31a5f..8c3d28af 100644
--- a/common.c
+++ b/common.c
@@ -447,15 +447,17 @@ int check_dir(char *dirname)
 void check_overflow(unsigned int val1, unsigned int val2,
 		    unsigned int val3)
 {
-	if ((unsigned long long) val1 * (unsigned long long) val2 *
-	    (unsigned long long) val3 > UINT_MAX) {
+	if ((val1 != 0) && (val2 != 0) && (val3 != 0) &&
+	    (((unsigned long long) UINT_MAX / (unsigned long long) val1 <
+	      (unsigned long long) val2) ||
+	     ((unsigned long long) UINT_MAX / ((unsigned long long) val1 * (unsigned long long) val2) <
+	      (unsigned long long) val3))) {
 #ifdef DEBUG
-		fprintf(stderr, "%s: Overflow detected (%llu). Aborting...\n",
-			__FUNCTION__, (unsigned long long) val1 * (unsigned long long) val2 *
-			(unsigned long long) val3);
+		fprintf(stderr, "%s: Overflow detected (%u,%u,%u). Aborting...\n",
+			__FUNCTION__, val1, val2, val3);
 #endif
-	exit(4);
-		}
+		exit(4);
+	}
 }
 
 #ifndef SOURCE_SADC
